<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Themed Alola Pokémon Selector (The Ultimate Roster)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        .main-view, .list-view {
            max-width: 850px;
            margin: 0 auto;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .list-view {
            display: none;
        }
        h1 {
            color: #1a73e8;
            text-align: center;
        }
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #e9e9e9;
        }
        .control-group label, .control-group select {
            display: block;
            width: 100%;
            margin-bottom: 5px;
        }
        .control-group select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
        .legendary-controls {
            grid-column: 1 / 4;
            display: flex;
            justify-content: space-around;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }
        button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            font-size: 18px;
            cursor: pointer;
            background-color: #1a73e8;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        button:hover {
            background-color: #155bb5;
        }
        #result-box {
            min-height: 180px;
            margin-top: 20px;
            padding: 20px;
            border: 2px solid #ffde00;
            border-radius: 8px;
            background-color: #fff; /* Default white background */
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s;
        }
        .shiny-background {
            background-color: #ffe066 !important; /* Yellow background for shiny */
            border-color: #cc9900 !important;
        }
        #pokemon-name {
            font-size: 2.2em;
            font-weight: bold;
            color: #cc0000;
            text-shadow: 1px 1px 1px #888;
            margin-bottom: 15px;
        }
        .shiny-label {
            color: #1a73e8;
            font-size: 0.7em;
            margin-left: 10px;
        }
        #pokemon-category-info {
            font-style: italic;
            color: #555;
            margin-bottom: 10px;
            text-transform: capitalize;
        }
        .stats-table {
            width: 100%;
            margin-bottom: 15px;
            border-collapse: collapse;
            font-size: 0.9em;
        }
        .stats-table td {
            text-align: center;
            padding: 4px 0;
            border: 1px solid #eee;
        }
        .stats-table tr:first-child td {
            font-weight: bold;
            background-color: #f0f0f0;
        }
        .move-table {
            width: 100%;
            margin: 15px auto;
            border-collapse: collapse;
        }
        .move-table th, .move-table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
            font-size: 0.9em;
        }
        .move-table th {
            background-color: #eee;
        }
        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .pokemon-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .card-name {
            font-size: 1.5em;
            color: #1a73e8;
            margin-bottom: 5px;
        }
        .card-details {
            font-size: 0.9em;
            color: #555;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="main-view" id="main-view">
    <h1>Themed Alola Pokémon Selector ☀️</h1>

    <div class="controls-grid">
        <div class="control-group">
            <label for="occasion-select">Occasion/Habitat:</label>
            <select id="occasion-select">
                <option value="all">All Habitats</option>
                <option value="jungle">Jungle / Forest</option>
                <option value="desert">Desert / Mountain</option>
                <option value="plains">Plains / Route</option>
                <option value="city">City / Urban</option>
                <option value="cave">Cave / Underworld</option>
                <option value="water">Water / Beach</option>
            </select>
        </div>
        <div class="control-group">
            <label for="type-select">Pokémon Type:</label>
            <select id="type-select">
                <option value="all">All Types</option>
                <option value="normal">Normal</option>
                <option value="fire">Fire</option>
                <option value="water">Water</option>
                <option value="grass">Grass</option>
                <option value="electric">Electric</option>
                <option value="ice">Ice</option>
                <option value="fighting">Fighting</option>
                <option value="poison">Poison</option>
                <option value="ground">Ground</option>
                <option value="flying">Flying</option>
                <option value="psychic">Psychic</option>
                <option value="bug">Bug</option>
                <option value="rock">Rock</option>
                <option value="ghost">Ghost</option>
                <option value="dragon">Dragon</option>
                <option value="steel">Steel</option>
                <option value="dark">Dark</option>
                <option value="fairy">Fairy</option>
            </select>
        </div>
        <div class="control-group">
            <label for="evolution-select">Evolution Stage:</label>
            <select id="evolution-select">
                <option value="all">All Stages</option>
                <option value="lowest">Lowest Evolution</option>
                <option value="middle">Middle Evolution</option>
                <option value="highest">Highest Evolution</option>
            </select>
        </div>
        <div class="legendary-controls">
            <label>
                <input type="checkbox" id="include-legendary" checked>
                Include Legendary/Mythical
            </label>
            <label>
                <input type="checkbox" id="include-ultrabeast" checked>
                Include Ultra Beasts
            </label>
        </div>
    </div>

    <button onclick="getRandomPokemon()">Find Themed Pokémon!</button>

    <div id="result-box">
        <p id="pokemon-name">Select your filters and go!</p>
        <p id="pokemon-category-info"></p>
        <div id="moves-list">
            </div>
    </div>
    
    <p style="text-align: center; font-size: 0.8em; margin-top: 15px; color: #777;">
        <span id="history-status">The selector will avoid recent repeats.</span>
    </p>

    <button onclick="toggleListView()">View Entire List (400+ Pokémon)</button>

</div>

<div class="list-view" id="list-view">
    <div class="list-header">
        <h1>Full Pokémon Roster</h1>
        <button onclick="toggleListView()" style="width: 150px;">Return to Selector</button>
    </div>
    <div id="full-list-content">
        </div>
</div>

<script>
    // --- POKÉMON DATA (FIRST ~50 ENTRIES - YOU MUST ADD THE REST UP TO 400+) ---
    // Structure: { name, category, evolution, types, habitat, stats: {hp, atk, def, spa, spd, spe}, moves: [[name, dmg, acc, heal], ...] }
    // Please continue adding all ~400 entries below this comment.
    const pokemonData = [
        // 001. Rowlet
        { 
            name: "Rowlet", category: "Standard", evolution: "lowest", types: ["grass", "flying"], habitat: "jungle", 
            stats: { hp: 68, atk: 55, def: 55, spa: 50, spd: 50, spe: 42 }, 
            moves: [["Leafage", 40, 100, 0], ["Tackle", 40, 100, 0], ["Growl", 0, 100, 0], ["Peck", 35, 100, 0], ["Razor Leaf", 55, 95, 0]] 
        },
        // 002. Dartrix
        { 
            name: "Dartrix", category: "Standard", evolution: "middle", types: ["grass", "flying"], habitat: "jungle", 
            stats: { hp: 78, atk: 75, def: 75, spa: 70, spd: 70, spe: 52 }, 
            moves: [["Razor Leaf", 55, 95, 0], ["Pluck", 60, 100, 0], ["Sucker Punch", 70, 100, 0], ["Foresight", 0, 100, 0], ["Synthesis", 0, '—', 50]] 
        },
        // 003. Decidueye
        { 
            name: "Decidueye", category: "Standard", evolution: "highest", types: ["grass", "ghost"], habitat: "jungle", 
            stats: { hp: 88, atk: 107, def: 75, spa: 100, spd: 100, spe: 70 }, 
            moves: [["Spirit Shackle", 80, 100, 0], ["Leaf Blade", 90, 100, 0], ["Brave Bird", 120, 100, 0], ["Sucker Punch", 70, 100, 0], ["U-turn", 70, 100, 0]] 
        },
        // 004. Litten
        { 
            name: "Litten", category: "Standard", evolution: "lowest", types: ["fire"], habitat: "plains", 
            stats: { hp: 45, atk: 65, def: 40, spa: 60, spd: 40, spe: 70 }, 
            moves: [["Scratch", 40, 100, 0], ["Ember", 40, 100, 0], ["Growl", 0, 100, 0], ["Lick", 30, 100, 0], ["Fire Fang", 65, 95, 0]] 
        },
        // 005. Torracat
        { 
            name: "Torracat", category: "Standard", evolution: "middle", types: ["fire"], habitat: "plains", 
            stats: { hp: 65, atk: 85, def: 50, spa: 80, spd: 50, spe: 90 }, 
            moves: [["Fire Fang", 65, 95, 0], ["Lariat", 85, 100, 0], ["Bite", 60, 100, 0], ["Roar", 0, 100, 0], ["Bulk Up", 0, '—', 0]] 
        },
        // 006. Incineroar
        { 
            name: "Incineroar", category: "Standard", evolution: "highest", types: ["fire", "dark"], habitat: "city", 
            stats: { hp: 95, atk: 115, def: 90, spa: 80, spd: 90, spe: 60 }, 
            moves: [["Darkest Lariat", 85, 100, 0], ["Throat Chop", 80, 100, 0], ["Flare Blitz", 120, 100, 0], ["Cross Chop", 100, 80, 0], ["U-turn", 70, 100, 0]] 
        },
        // 007. Popplio
        { 
            name: "Popplio", category: "Standard", evolution: "lowest", types: ["water"], habitat: "water", 
            stats: { hp: 50, atk: 54, def: 54, spa: 66, spd: 56, spe: 40 }, 
            moves: [["Pound", 40, 100, 0], ["Water Gun", 40, 100, 0], ["Growl", 0, 100, 0], ["Aqua Jet", 40, 100, 0], ["Disarming Voice", 40, '—', 0]] 
        },
        // 008. Brionne
        { 
            name: "Brionne", category: "Standard", evolution: "middle", types: ["water"], habitat: "water", 
            stats: { hp: 60, atk: 69, def: 69, spa: 91, spd: 81, spe: 50 }, 
            moves: [["Aqua Jet", 40, 100, 0], ["Disarming Voice", 40, '—', 0], ["Bubble Beam", 65, 100, 0], ["Encore", 0, 100, 0], ["Ice Beam", 90, 100, 0]] 
        },
        // 009. Primarina
        { 
            name: "Primarina", category: "Standard", evolution: "highest", types: ["water", "fairy"], habitat: "water", 
            stats: { hp: 80, atk: 74, def: 74, spa: 126, spd: 116, spe: 60 }, 
            moves: [["Sparkling Aria", 90, 100, 0], ["Moonblast", 95, 100, 0], ["Hydro Pump", 110, 80, 0], ["Ice Beam", 90, 100, 0], ["Psychic", 90, 100, 0]] 
        },
        // 010. Pikipek
        { 
            name: "Pikipek", category: "Standard", evolution: "lowest", types: ["normal", "flying"], habitat: "jungle", 
            stats: { hp: 35, atk: 75, def: 30, spa: 30, spd: 30, spe: 65 }, 
            moves: [["Peck", 35, 100, 0], ["Rock Blast", 25, 90, 0], ["Echoed Voice", 40, 100, 0], ["Growl", 0, 100, 0], ["Roost", 0, '—', 50]] 
        },
        // 011. Trumbeak
        { 
            name: "Trumbeak", category: "Standard", evolution: "middle", types: ["normal", "flying"], habitat: "jungle", 
            stats: { hp: 55, atk: 85, def: 50, spa: 40, spd: 50, spe: 75 }, 
            moves: [["Beak Blast", 100, 100, 0], ["Fury Attack", 15, 85, 0], ["Roost", 0, '—', 50], ["Screech", 0, 85, 0], ["Pluck", 60, 100, 0]] 
        },
        // 012. Toucannon
        { 
            name: "Toucannon", category: "Standard", evolution: "highest", types: ["normal", "flying"], habitat: "jungle", 
            stats: { hp: 80, atk: 120, def: 75, spa: 75, spd: 75, spe: 60 }, 
            moves: [["Beak Blast", 100, 100, 0], ["Brave Bird", 120, 100, 0], ["Bullet Seed", 25, 100, 0], ["U-turn", 70, 100, 0], ["Roost", 0, '—', 50]] 
        },
        // 013. Yungoos
        { 
            name: "Yungoos", category: "Standard", evolution: "lowest", types: ["normal"], habitat: "plains", 
            stats: { hp: 48, atk: 70, def: 30, spa: 30, spd: 30, spe: 45 }, 
            moves: [["Tackle", 40, 100, 0], ["Pursuit", 40, 100, 0], ["Bite", 60, 100, 0], ["Sand Attack", 0, 100, 0], ["Crunch", 80, 100, 0]] 
        },
        // 014. Gumshoos
        { 
            name: "Gumshoos", category: "Standard", evolution: "highest", types: ["normal"], habitat: "plains", 
            stats: { hp: 88, atk: 110, def: 60, spa: 55, spd: 60, spe: 45 }, 
            moves: [["Stakeout", 0, '—', 0], ["Crunch", 80, 100, 0], ["Hyper Fang", 80, 90, 0], ["U-turn", 70, 100, 0], ["Revenge", 60, 100, 0]] 
        },
        // 015. Alolan Rattata
        { 
            name: "Alolan Rattata", category: "Standard", evolution: "lowest", types: ["dark", "normal"], habitat: "city", 
            stats: { hp: 30, atk: 56, def: 35, spa: 25, spd: 35, spe: 72 }, 
            moves: [["Bite", 60, 100, 0], ["Tackle", 40, 100, 0], ["Sucker Punch", 70, 100, 0], ["Focus Energy", 0, '—', 0], ["Hyper Fang", 80, 90, 0]] 
        },
        // 016. Alolan Raticate
        { 
            name: "Alolan Raticate", category: "Standard", evolution: "middle", types: ["dark", "normal"], habitat: "city", 
            stats: { hp: 75, atk: 71, def: 70, spa: 40, spd: 80, spe: 77 }, 
            moves: [["Crunch", 80, 100, 0], ["Sucker Punch", 70, 100, 0], ["Dark Pulse", 80, 100, 0], ["Hyper Fang", 80, 90, 0], ["Swords Dance", 0, '—', 0]] 
        },
        // 017. Alolan Caterpie
        { 
            name: "Caterpie", category: "Standard", evolution: "lowest", types: ["bug"], habitat: "jungle", 
            stats: { hp: 45, atk: 30, def: 35, spa: 20, spd: 20, spe: 45 }, 
            moves: [["Tackle", 40, 100, 0], ["String Shot", 0, 95, 0], ["Bug Bite", 60, 100, 0], ["Electroweb", 55, 95, 0], ["Stun Spore", 0, 75, 0]] 
        },
        // 018. Metapod
        { 
            name: "Metapod", category: "Standard", evolution: "middle", types: ["bug"], habitat: "jungle", 
            stats: { hp: 50, atk: 20, def: 55, spa: 25, spd: 25, spe: 30 }, 
            moves: [["Harden", 0, '—', 0], ["Iron Defense", 0, '—', 0], ["Bug Bite", 60, 100, 0], ["Electroweb", 55, 95, 0], ["Stun Spore", 0, 75, 0]] 
        },
        // 019. Butterfree
        { 
            name: "Butterfree", category: "Standard", evolution: "highest", types: ["bug", "flying"], habitat: "jungle", 
            stats: { hp: 60, atk: 45, def: 50, spa: 90, spd: 80, spe: 70 }, 
            moves: [["Quiver Dance", 0, '—', 0], ["Bug Buzz", 90, 100, 0], ["Air Slash", 75, 95, 0], ["Sleep Powder", 0, 75, 0], ["Hurricane", 110, 70, 0]] 
        },
        // 020. Alolan Pichu
        { 
            name: "Pichu", category: "Standard", evolution: "lowest", types: ["electric"], habitat: "plains", 
            stats: { hp: 20, atk: 40, def: 15, spa: 35, spd: 35, spe: 60 }, 
            moves: [["Thunder Shock", 40, 100, 0], ["Tail Whip", 0, 100, 0], ["Charm", 0, 100, 0], ["Volt Switch", 70, 100, 0], ["Nuzzle", 20, 100, 0]] 
        },
        // 021. Alolan Pikachu
        { 
            name: "Pikachu", category: "Standard", evolution: "middle", types: ["electric"], habitat: "plains", 
            stats: { hp: 35, atk: 55, def: 40, spa: 50, spd: 50, spe: 90 }, 
            moves: [["Thunderbolt", 90, 100, 0], ["Quick Attack", 40, 100, 0], ["Iron Tail", 100, 75, 0], ["Nuzzle", 20, 100, 0], ["Volt Switch", 70, 100, 0]] 
        },
        // 022. Alolan Raichu
        { 
            name: "Alolan Raichu", category: "Standard", evolution: "highest", types: ["electric", "psychic"], habitat: "water", 
            stats: { hp: 60, atk: 85, def: 50, spa: 95, spd: 85, spe: 110 }, 
            moves: [["Thunderbolt", 90, 100, 0], ["Psychic", 90, 100, 0], ["Surf", 90, 100, 0], ["Focus Blast", 120, 70, 0], ["Nasty Plot", 0, '—', 0]] 
        },
        // 023. Alolan Abra
        { 
            name: "Abra", category: "Standard", evolution: "lowest", types: ["psychic"], habitat: "city", 
            stats: { hp: 25, atk: 20, def: 15, spa: 105, spd: 55, spe: 90 }, 
            moves: [["Teleport", 0, '—', 0], ["Psychic", 90, 100, 0], ["Dazzling Gleam", 80, 100, 0], ["Recover", 0, '—', 50], ["Calm Mind", 0, '—', 0]] 
        },
        // 024. Kadabra
        { 
            name: "Kadabra", category: "Standard", evolution: "middle", types: ["psychic"], habitat: "city", 
            stats: { hp: 40, atk: 35, def: 30, spa: 120, spd: 70, spe: 105 }, 
            moves: [["Psychic", 90, 100, 0], ["Dazzling Gleam", 80, 100, 0], ["Shadow Ball", 80, 100, 0], ["Recover", 0, '—', 50], ["Calm Mind", 0, '—', 0]] 
        },
        // 025. Alakazam
        { 
            name: "Alakazam", category: "Standard", evolution: "highest", types: ["psychic"], habitat: "city", 
            stats: { hp: 55, atk: 50, def: 45, spa: 135, spd: 95, spe: 120 }, 
            moves: [["Psychic", 90, 100, 0], ["Focus Blast", 120, 70, 0], ["Shadow Ball", 80, 100, 0], ["Energy Ball", 90, 100, 0], ["Calm Mind", 0, '—', 0]] 
        },
        // 026. Alolan Meowth
        { 
            name: "Alolan Meowth", category: "Standard", evolution: "lowest", types: ["dark"], habitat: "city", 
            stats: { hp: 40, atk: 35, def: 35, spa: 50, spd: 40, spe: 90 }, 
            moves: [["Foul Play", 95, 100, 0], ["Bite", 60, 100, 0], ["Snarl", 55, 100, 0], ["Dark Pulse", 80, 100, 0], ["Fake Out", 40, 100, 0]] 
        },
        // 027. Alolan Persian
        { 
            name: "Alolan Persian", category: "Standard", evolution: "highest", types: ["dark"], habitat: "city", 
            stats: { hp: 65, atk: 60, def: 60, spa: 75, spd: 65, spe: 115 }, 
            moves: [["Foul Play", 95, 100, 0], ["Dark Pulse", 80, 100, 0], ["Power Gem", 80, 100, 0], ["Nasty Plot", 0, '—', 0], ["U-turn", 70, 100, 0]] 
        },
        // 028. Alolan Gastly
        { 
            name: "Gastly", category: "Standard", evolution: "lowest", types: ["ghost", "poison"], habitat: "cave", 
            stats: { hp: 30, atk: 35, def: 30, spa: 100, spd: 35, spe: 80 }, 
            moves: [["Shadow Ball", 80, 100, 0], ["Sludge Bomb", 90, 100, 0], ["Hypnosis", 0, 60, 0], ["Will-O-Wisp", 0, 85, 0], ["Destiny Bond", 0, '—', 0]] 
        },
        // 029. Haunter
        { 
            name: "Haunter", category: "Standard", evolution: "middle", types: ["ghost", "poison"], habitat: "cave", 
            stats: { hp: 45, atk: 50, def: 45, spa: 115, spd: 55, spe: 95 }, 
            moves: [["Shadow Ball", 80, 100, 0], ["Sludge Bomb", 90, 100, 0], ["Hypnosis", 0, 60, 0], ["Will-O-Wisp", 0, 85, 0], ["Destiny Bond", 0, '—', 0]] 
        },
        // 030. Gengar
        { 
            name: "Gengar", category: "Standard", evolution: "highest", types: ["ghost", "poison"], habitat: "cave", 
            stats: { hp: 60, atk: 65, def: 60, spa: 130, spd: 75, spe: 110 }, 
            moves: [["Shadow Ball", 80, 100, 0], ["Sludge Bomb", 90, 100, 0], ["Focus Blast", 120, 70, 0], ["Dazzling Gleam", 80, 100, 0], ["Substitute", 0, '—', 0]] 
        },
        // 031. Alolan Diglett
        { 
            name: "Alolan Diglett", category: "Standard", evolution: "lowest", types: ["ground", "steel"], habitat: "cave", 
            stats: { hp: 10, atk: 55, def: 30, spa: 35, spd: 45, spe: 90 }, 
            moves: [["Magnitude", 70, 100, 0], ["Sucker Punch", 70, 100, 0], ["Metal Claw", 50, 95, 0], ["Iron Head", 80, 100, 0], ["Rock Slide", 75, 90, 0]] 
        },
        // 032. Alolan Dugtrio
        { 
            name: "Alolan Dugtrio", category: "Standard", evolution: "highest", types: ["ground", "steel"], habitat: "cave", 
            stats: { hp: 35, atk: 100, def: 60, spa: 50, spd: 70, spe: 110 }, 
            moves: [["Iron Head", 80, 100, 0], ["Earthquake", 100, 100, 0], ["Sucker Punch", 70, 100, 0], ["Stone Edge", 100, 80, 0], ["Reversal", 0, 100, 0]] 
        },
        // 033. Alolan Zubat
        { 
            name: "Zubat", category: "Standard", evolution: "lowest", types: ["poison", "flying"], habitat: "cave", 
            stats: { hp: 40, atk: 45, def: 35, spa: 30, spd: 40, spe: 55 }, 
            moves: [["Bite", 60, 100, 0], ["Air Cutter", 60, 95, 0], ["Acrobatics", 55, 100, 0], ["U-turn", 70, 100, 0], ["Roost", 0, '—', 50]] 
        },
        // 034. Golbat
        { 
            name: "Golbat", category: "Standard", evolution: "middle", types: ["poison", "flying"], habitat: "cave", 
            stats: { hp: 75, atk: 80, def: 70, spa: 65, spd: 75, spe: 90 }, 
            moves: [["Air Slash", 75, 95, 0], ["Bite", 60, 100, 0], ["Acrobatics", 55, 100, 0], ["U-turn", 70, 100, 0], ["Roost", 0, '—', 50]] 
        },
        // 035. Crobat
        { 
            name: "Crobat", category: "Standard", evolution: "highest", types: ["poison", "flying"], habitat: "cave", 
            stats: { hp: 85, atk: 90, def: 80, spa: 70, spd: 80, spe: 130 }, 
            moves: [["Brave Bird", 120, 100, 0], ["Cross Poison", 70, 100, 0], ["U-turn", 70, 100, 0], ["Roost", 0, '—', 50], ["Defog", 0, '—', 0]] 
        },
        // 036. Alolan Munchlax
        { 
            name: "Munchlax", category: "Standard", evolution: "lowest", types: ["normal"], habitat: "plains", 
            stats: { hp: 135, atk: 85, def: 40, spa: 40, spd: 85, spe: 5 }, 
            moves: [["Recycle", 0, '—', 0], ["Body Slam", 85, 100, 0], ["Swallow", 0, '—', 0], ["Rest", 0, '—', 100], ["Belly Drum", 0, '—', 0]] 
        },
        // 037. Snorlax
        { 
            name: "Snorlax", category: "Standard", evolution: "highest", types: ["normal"], habitat: "plains", 
            stats: { hp: 160, atk: 110, def: 65, spa: 65, spd: 110, spe: 30 }, 
            moves: [["Body Slam", 85, 100, 0], ["Heavy Slam", 0, 100, 0], ["Rest", 0, '—', 100], ["Earthquake", 100, 100, 0], ["Curse", 0, '—', 0]] 
        },
        // 038. Alolan Cutiefly
        { 
            name: "Cutiefly", category: "Standard", evolution: "lowest", types: ["bug", "fairy"], habitat: "jungle", 
            stats: { hp: 40, atk: 45, def: 40, spa: 55, spd: 40, spe: 84 }, 
            moves: [["Fairy Wind", 40, 100, 0], ["Stun Spore", 0, 75, 0], ["Struggle Bug", 50, 100, 0], ["Draining Kiss", 50, 100, 50], ["Bug Buzz", 90, 100, 0]] 
        },
        // 039. Ribombee
        { 
            name: "Ribombee", category: "Standard", evolution: "highest", types: ["bug", "fairy"], habitat: "jungle", 
            stats: { hp: 60, atk: 55, def: 60, spa: 95, spd: 70, spe: 124 }, 
            moves: [["Pollen Puff", 90, 100, 0], ["Quiver Dance", 0, '—', 0], ["Bug Buzz", 90, 100, 0], ["Moonblast", 95, 100, 0], ["Sticky Web", 0, '—', 0]] 
        },
        // 040. Alolan Growlithe
        { 
            name: "Growlithe", category: "Standard", evolution: "lowest", types: ["fire"], habitat: "plains", 
            stats: { hp: 55, atk: 70, def: 45, spa: 70, spd: 50, spe: 60 }, 
            moves: [["Flare Blitz", 120, 100, 0], ["Wild Charge", 90, 100, 0], ["Close Combat", 120, 100, 0], ["Morning Sun", 0, '—', 50], ["Roar", 0, 100, 0]] 
        },
        // 041. Arcanine
        { 
            name: "Arcanine", category: "Standard", evolution: "highest", types: ["fire"], habitat: "plains", 
            stats: { hp: 90, atk: 110, def: 80, spa: 100, spd: 80, spe: 95 }, 
            moves: [["Flare Blitz", 120, 100, 0], ["Extreme Speed", 80, 100, 0], ["Wild Charge", 90, 100, 0], ["Close Combat", 120, 100, 0], ["Morning Sun", 0, '—', 50]] 
        },
        // 042. Alolan Grimer
        { 
            name: "Alolan Grimer", category: "Standard", evolution: "lowest", types: ["poison", "dark"], habitat: "city", 
            stats: { hp: 80, atk: 80, def: 50, spa: 40, spd: 50, spe: 25 }, 
            moves: [["Poison Jab", 80, 100, 0], ["Knock Off", 65, 100, 0], ["Minimize", 0, '—', 0], ["Crunch", 80, 100, 0], ["Gunk Shot", 120, 80, 0]] 
        },
        // 043. Alolan Muk
        { 
            name: "Alolan Muk", category: "Standard", evolution: "highest", types: ["poison", "dark"], habitat: "city", 
            stats: { hp: 105, atk: 105, def: 75, spa: 65, spd: 100, spe: 50 }, 
            moves: [["Poison Jab", 80, 100, 0], ["Gunk Shot", 120, 80, 0], ["Crunch", 80, 100, 0], ["Knock Off", 65, 100, 0], ["Shadow Sneak", 40, 100, 0]] 
        },
        // 044. Alolan Misdreavus
        { 
            name: "Misdreavus", category: "Standard", evolution: "lowest", types: ["ghost"], habitat: "cave", 
            stats: { hp: 60, atk: 60, def: 60, spa: 85, spd: 85, spe: 85 }, 
            moves: [["Shadow Ball", 80, 100, 0], ["Thunderbolt", 90, 100, 0], ["Will-O-Wisp", 0, 85, 0], ["Perish Song", 0, '—', 0], ["Nasty Plot", 0, '—', 0]] 
        },
        // 045. Mismagius
        { 
            name: "Mismagius", category: "Standard", evolution: "highest", types: ["ghost"], habitat: "cave", 
            stats: { hp: 60, atk: 60, def: 60, spa: 105, spd: 105, spe: 105 }, 
            moves: [["Shadow Ball", 80, 100, 0], ["Thunderbolt", 90, 100, 0], ["Will-O-Wisp", 0, 85, 0], ["Mystical Fire", 75, 100, 0], ["Nasty Plot", 0, '—', 0]] 
        },
        // 046. Alolan Drifloon
        { 
            name: "Drifloon", category: "Standard", evolution: "lowest", types: ["ghost", "flying"], habitat: "plains", 
            stats: { hp: 90, atk: 50, def: 34, spa: 60, spd: 44, spe: 70 }, 
            moves: [["Shadow Ball", 80, 100, 0], ["Will-O-Wisp", 0, 85, 0], ["Acrobatics", 55, 100, 0], ["Destiny Bond", 0, '—', 0], ["Defog", 0, '—', 0]] 
        },
        // 047. Drifblim
        { 
            name: "Drifblim", category: "Standard", evolution: "highest", types: ["ghost", "flying"], habitat: "plains", 
            stats: { hp: 150, atk: 80, def: 44, spa: 90, spd: 54, spe: 80 }, 
            moves: [["Shadow Ball", 80, 100, 0], ["Will-O-Wisp", 0, 85, 0], ["Acrobatics", 55, 100, 0], ["Explosion", 250, 100, 0], ["Defog", 0, '—', 0]] 
        },
        // 048. Alolan Murkrow
        { 
            name: "Murkrow", category: "Standard", evolution: "lowest", types: ["dark", "flying"], habitat: "city", 
            stats: { hp: 60, atk: 85, def: 42, spa: 85, spd: 42, spe: 91 }, 
            moves: [["Foul Play", 95, 100, 0], ["Sucker Punch", 70, 100, 0], ["Brave Bird", 120, 100, 0], ["Roost", 0, '—', 50], ["Quash", 0, 100, 0]] 
        },
        // 049. Honchkrow
        { 
            name: "Honchkrow", category: "Standard", evolution: "highest", types: ["dark", "flying"], habitat: "city", 
            stats: { hp: 100, atk: 125, def: 52, spa: 105, spd: 52, spe: 71 }, 
            moves: [["Foul Play", 95, 100, 0], ["Sucker Punch", 70, 100, 0], ["Brave Bird", 120, 100, 0], ["Roost", 0, '—', 50], ["Pursuit", 40, 100, 0]] 
        },
        // 050. Alolan Ekans
        { 
            name: "Ekans", category: "Standard", evolution: "lowest", types: ["poison"], habitat: "plains", 
            stats: { hp: 35, atk: 60, def: 44, spa: 40, spd: 54, spe: 55 }, 
            moves: [["Poison Jab", 80, 100, 0], ["Gunk Shot", 120, 80, 0], ["Coil", 0, '—', 0], ["Glare", 0, 100, 0], ["Aqua Tail", 90, 90, 0]] 
        },
        // --- ADD REMAINING POKÉMON ENTRIES HERE (Approx. 350 more needed) ---
    ];

    const history = [];
    const HISTORY_SIZE = 8; 

    // --- Core Logic ---

    function generateMoveTable(moves) {
        let html = '<h3>Known Moves</h3><table class="move-table"><thead><tr><th>Move</th><th>Power (DMG)</th><th>Accuracy (ACC)</th><th>Heal (HP)</th></tr></thead><tbody>';
        
        moves.forEach(move => {
            const [name, power, acc, health] = move;
            const powerDisplay = power > 0 ? power : 'N/A';
            const healthDisplay = health > 0 ? health + '%' : 'N/A';
            const accDisplay = acc !== 0 ? acc : '—';

            html += `<tr><td>${name}</td><td>${powerDisplay}</td><td>${accDisplay}</td><td>${healthDisplay}</td></tr>`;
        });

        html += '</tbody></table>';
        return html;
    }

    function generateStatsTable(stats) {
        if (!stats) return '';
        let html = '<h3>Base Stats</h3><table class="stats-table">';
        
        // Header Row
        html += '<tr><td>HP</td><td>ATK</td><td>DEF</td><td>SPA</td><td>SPD</td><td>SPE</td></tr>';
        
        // Data Row
        html += `<tr><td>${stats.hp}</td><td>${stats.atk}</td><td>${stats.def}</td><td>${stats.spa}</td><td>${stats.spd}</td><td>${stats.spe}</td></tr>`;
        
        html += '</table>';
        return html;
    }

    function getRandomPokemon() {
        const occasionFilter = document.getElementById('occasion-select').value;
        const typeFilter = document.getElementById('type-select').value;
        const evolutionFilter = document.getElementById('evolution-select').value;
        const includeLegendary = document.getElementById('include-legendary').checked;
        const includeUltraBeast = document.getElementById('include-ultrabeast').checked;
        const resultBox = document.getElementById('result-box');
        
        // Shiny Roll (1 in 100)
        const isShiny = Math.floor(Math.random() * 100) === 0;

        const filteredList = pokemonData.filter(p => {
            const isLegendary = p.category === 'Legendary' || p.category === 'Mythical';
            const isUltraBeast = p.category === 'Ultra Beast';
            
            if (isLegendary && !includeLegendary) return false;
            if (isUltraBeast && !includeUltraBeast) return false;

            if (p.category === 'Standard' || p.category === 'Legendary') { // Legendary Type: Null is Standard-like
                if (occasionFilter !== 'all' && p.habitat !== occasionFilter) return false;
                if (evolutionFilter !== 'all' && p.evolution !== evolutionFilter) return false;
            }
            
            if (typeFilter !== 'all' && !p.types.includes(typeFilter)) return false;

            return true;
        });

        let availablePokemon = filteredList.filter(p => !history.includes(p.name));

        const resultName = document.getElementById('pokemon-name');
        const movesListElement = document.getElementById('moves-list');
        const historyStatus = document.getElementById('history-status');
        const categoryInfo = document.getElementById('pokemon-category-info');

        if (filteredList.length === 0) {
            resultName.textContent = "No Pokémon available with current filters.";
            categoryInfo.textContent = "Try adjusting your filters!";
            movesListElement.innerHTML = '';
            historyStatus.textContent = "History tracking is paused.";
            resultBox.classList.remove('shiny-background');
            return;
        }

        if (availablePokemon.length === 0) {
            availablePokemon = filteredList;
            history.length = 0; 
            console.log("History reset to allow for a new selection.");
        }

        const randomIndex = Math.floor(Math.random() * availablePokemon.length);
        const selectedPokemon = availablePokemon[randomIndex];

        // Apply Shiny Styling
        if (isShiny) {
            resultName.innerHTML = `${selectedPokemon.name} <span class="shiny-label">(Shiny) ✨</span>`;
            resultBox.classList.add('shiny-background');
        } else {
            resultName.textContent = selectedPokemon.name;
            resultBox.classList.remove('shiny-background');
        }

        // Update display 
        categoryInfo.innerHTML = `Category: ${selectedPokemon.category} | Types: ${selectedPokemon.types.map(t => t.charAt(0).toUpperCase() + t.slice(1)).join(', ')} | Evolution Stage: ${selectedPokemon.evolution.charAt(0).toUpperCase() + selectedPokemon.evolution.slice(1)}`;
        
        // Combine Stats and Moves tables
        movesListElement.innerHTML = generateStatsTable(selectedPokemon.stats) + generateMoveTable(selectedPokemon.moves);

        // Update history
        history.push(selectedPokemon.name);
        if (history.length > HISTORY_SIZE) {
            history.shift(); 
        }
        
        historyStatus.textContent = `Last ${history.length} selections (No Repetition): ${history.join(', ')}`;
    }

    // --- Entire List View Logic ---

    function generateFullListContent() {
        const listContainer = document.getElementById('full-list-content');
        listContainer.innerHTML = ''; 

        // Sort the list alphabetically for better viewing
        const sortedData = [...pokemonData].sort((a, b) => a.name.localeCompare(b.name));

        sortedData.forEach(p => {
            const card = document.createElement('div');
            card.className = 'pokemon-card';
            
            const nameEl = document.createElement('div');
            nameEl.className = 'card-name';
            nameEl.textContent = p.name;
            
            const detailsEl = document.createElement('div');
            detailsEl.className = 'card-details';
            detailsEl.innerHTML = `
                Category: ${p.category} | 
                Evolution: ${p.evolution.charAt(0).toUpperCase() + p.evolution.slice(1)} | 
                Types: ${p.types.map(t => t.charAt(0).toUpperCase() + t.slice(1)).join(', ')} |
                Habitat: ${p.habitat.charAt(0).toUpperCase() + p.habitat.slice(1)}
            `;

            card.appendChild(nameEl);
            card.appendChild(detailsEl);
            card.innerHTML += generateStatsTable(p.stats);
            card.innerHTML += generateMoveTable(p.moves);
            
            listContainer.appendChild(card);
        });
    }

    function toggleListView() {
        const mainView = document.getElementById('main-view');
        const listView = document.getElementById('list-view');

        if (mainView.style.display !== 'none') {
            generateFullListContent(); 
            mainView.style.display = 'none';
            listView.style.display = 'block';
        } else {
            listView.style.display = 'none';
            mainView.style.display = 'block';
        }
    }
</script>

</body>
</html>
